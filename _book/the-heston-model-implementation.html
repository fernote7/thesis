<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  

<meta name="author" content="Fernando O. Teixeira">


<meta name="date" content="2017-09-16">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="lt-review.html">
<link rel="next" href="results.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="lt-review.html"><a href="lt-review.html"><i class="fa fa-check"></i><b>1</b> Literature Review</a><ul>
<li class="chapter" data-level="1.1" data-path="lt-review.html"><a href="lt-review.html#stochastic-calculus"><i class="fa fa-check"></i><b>1.1</b> Stochastic Calculus</a><ul>
<li class="chapter" data-level="1.1.1" data-path="lt-review.html"><a href="lt-review.html#the-stochastic-differential-equation---sde"><i class="fa fa-check"></i><b>1.1.1</b> The Stochastic differential equation - SDE</a></li>
<li class="chapter" data-level="1.1.2" data-path="lt-review.html"><a href="lt-review.html#brownian-motion"><i class="fa fa-check"></i><b>1.1.2</b> Brownian Motion</a></li>
<li class="chapter" data-level="1.1.3" data-path="lt-review.html"><a href="lt-review.html#itos-integral"><i class="fa fa-check"></i><b>1.1.3</b> Itô’s Integral</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="lt-review.html"><a href="lt-review.html#black-scholes-model"><i class="fa fa-check"></i><b>1.2</b> Black-Scholes Model</a><ul>
<li class="chapter" data-level="1.2.1" data-path="lt-review.html"><a href="lt-review.html#basics"><i class="fa fa-check"></i><b>1.2.1</b> Basics</a></li>
<li class="chapter" data-level="1.2.2" data-path="lt-review.html"><a href="lt-review.html#the-model"><i class="fa fa-check"></i><b>1.2.2</b> The model</a></li>
<li class="chapter" data-level="1.2.3" data-path="lt-review.html"><a href="lt-review.html#limitations"><i class="fa fa-check"></i><b>1.2.3</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="lt-review.html"><a href="lt-review.html#stochastic-volatility-models"><i class="fa fa-check"></i><b>1.3</b> Stochastic Volatility models</a><ul>
<li class="chapter" data-level="1.3.1" data-path="lt-review.html"><a href="lt-review.html#cir"><i class="fa fa-check"></i><b>1.3.1</b> Cox-Ingersoll-Ross model</a></li>
<li class="chapter" data-level="1.3.2" data-path="lt-review.html"><a href="lt-review.html#hes1"><i class="fa fa-check"></i><b>1.3.2</b> Heston Model</a></li>
<li class="chapter" data-level="1.3.3" data-path="lt-review.html"><a href="lt-review.html#other-models"><i class="fa fa-check"></i><b>1.3.3</b> Other Models</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="lt-review.html"><a href="lt-review.html#numerical-methods"><i class="fa fa-check"></i><b>1.4</b> Numerical Methods</a><ul>
<li class="chapter" data-level="1.4.1" data-path="lt-review.html"><a href="lt-review.html#convergence"><i class="fa fa-check"></i><b>1.4.1</b> Convergence</a></li>
<li class="chapter" data-level="1.4.2" data-path="lt-review.html"><a href="lt-review.html#discretization"><i class="fa fa-check"></i><b>1.4.2</b> Discretization</a></li>
<li class="chapter" data-level="1.4.3" data-path="lt-review.html"><a href="lt-review.html#stability"><i class="fa fa-check"></i><b>1.4.3</b> Stability</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-heston-model-implementation.html"><a href="the-heston-model-implementation.html"><i class="fa fa-check"></i><b>2</b> The Heston Model Implementation</a><ul>
<li class="chapter" data-level="2.1" data-path="the-heston-model-implementation.html"><a href="the-heston-model-implementation.html#characteristic-function"><i class="fa fa-check"></i><b>2.1</b> Characteristic Function</a></li>
<li class="chapter" data-level="2.2" data-path="the-heston-model-implementation.html"><a href="the-heston-model-implementation.html#euler-scheme"><i class="fa fa-check"></i><b>2.2</b> Euler Scheme</a></li>
<li class="chapter" data-level="2.3" data-path="the-heston-model-implementation.html"><a href="the-heston-model-implementation.html#kahl-jackel"><i class="fa fa-check"></i><b>2.3</b> Kahl-Jackel</a></li>
<li class="chapter" data-level="2.4" data-path="the-heston-model-implementation.html"><a href="the-heston-model-implementation.html#exact-algorithm"><i class="fa fa-check"></i><b>2.4</b> Exact Algorithm</a><ul>
<li class="chapter" data-level="2.4.1" data-path="the-heston-model-implementation.html"><a href="the-heston-model-implementation.html#generate-a-sample-of-v_t-given-v_0"><i class="fa fa-check"></i><b>2.4.1</b> Generate a sample of <span class="math inline">\(V_t\)</span> given <span class="math inline">\(V_0\)</span></a></li>
<li class="chapter" data-level="2.4.2" data-path="the-heston-model-implementation.html"><a href="the-heston-model-implementation.html#generate-a-sample-of-int_0t-v_sds-given-v_t-v_0"><i class="fa fa-check"></i><b>2.4.2</b> Generate a sample of <span class="math inline">\(\int_0^t V_sds\)</span> given <span class="math inline">\(V_t\)</span>, <span class="math inline">\(V_0\)</span></a></li>
<li class="chapter" data-level="2.4.3" data-path="the-heston-model-implementation.html"><a href="the-heston-model-implementation.html#compute-int_0t-sqrtv_sdb_s-given-v_t-v_0-and-int_0t-v_sds"><i class="fa fa-check"></i><b>2.4.3</b> Compute <span class="math inline">\(\int_0^t \sqrt{V_s}dB_s\)</span> given <span class="math inline">\(V_t\)</span>, <span class="math inline">\(V_0\)</span> and <span class="math inline">\(\int_0^t V_sds\)</span></a></li>
<li class="chapter" data-level="2.4.4" data-path="the-heston-model-implementation.html"><a href="the-heston-model-implementation.html#limitations-1"><i class="fa fa-check"></i><b>2.4.4</b> Limitations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>3</b> Results</a></li>
<li class="chapter" data-level="4" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>4</b> Conclusion</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="bsformula.html"><a href="bsformula.html"><i class="fa fa-check"></i><b>A</b> Black-Scholes formula</a></li>
<li class="chapter" data-level="B" data-path="bessel.html"><a href="bessel.html"><i class="fa fa-check"></i><b>B</b> Bessel Function</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-heston-model-implementation" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> The Heston Model Implementation</h1>
<p>In section <a href="lt-review.html#hes1">1.3.2</a> we presented Heston’s SDE system in one of its structures. Another common way <span class="citation">[1,4,24]</span> to write down the system is using the property presented in subsection <a href="lt-review.html#corr">1.1.2.1</a> as in equation <a href="#eq:heston2">(<strong>??</strong>)</a>.</p>
<span class="math display">\[\begin{align}
\label{eq:heston2}
\begin{split}
dS_t &amp;= \mu S_t dt + \rho \sqrt{V_t} dB_t + \sqrt{1 - \rho^2} \sqrt{V_t} S_t dW_t \\
dV_t &amp;= k(\theta - V_t)dt + \sigma \sqrt{V_t} dB_t 
\end{split}
\end{align}\]</span>
<div id="characteristic-function" class="section level2">
<h2><span class="header-section-number">2.1</span> Characteristic Function</h2>
<p>The Heston model characteristic function is firstly presented in the 1993 Steven Heston’s paper <span class="citation">[17]</span> and is described below <span class="citation">[9]</span>:</p>
<span class="math display">\[\begin{align}
f(S_t, V_t, t) = e^{A(T-t)+B(T-t)S_t + C(T-t)V_t + i \phi S_t}
\end{align}\]</span>
<p>If we let <span class="math inline">\(\tau = T-t\)</span>, then the explicit form of the Heston characteristic function is:</p>
<span class="math display">\[\begin{align*}
f(i \phi) &amp;= e^{A(\tau)+B(\tau)S_t + C(\tau)V_t + i \phi S_t} \\
A(\tau) &amp;= r i \phi \tau + \frac{\kappa \theta}{\sigma^2} \left[ - (\rho \sigma i \phi - \kappa - M) \tau - 2 \ln\left(\frac{1-N e^{M \tau}}{1-N}\right) \right] \\
B(\tau) &amp;= 0 \\
C(\tau) &amp;= \frac{(e^{M \tau}-1)(\rho \sigma i \phi - \kappa - M)}{\sigma^2 (1-N e^{M \tau})} \\
\text{Where:} &amp; \\
M &amp;= \sqrt{(\rho \sigma i \phi - \kappa)^2 + \sigma^2 (i \phi + \phi^2)} \\
N &amp;= \frac{\rho \sigma i \phi - \kappa - M}{\rho \sigma i \phi - \kappa + M} \\
\end{align*}\]</span>
<p>This function is the driving force behind the following formula, that calculates the fair valur of a European call option at time <span class="math inline">\(t\)</span>, given a strike price <span class="math inline">\(K\)</span>, that expires at time <span class="math inline">\(T\)</span> <span class="citation">[9]</span>:</p>
<span class="math display">\[\begin{align} 
\label{eq:cfheston}
\begin{split}
C = &amp; \frac{1}{2} S(t) + \frac{e^{-r(T-t)}}{\pi}\int_{0}^{\infty}{\Re \left[ \frac{K^{-i \phi} f(i \phi + 1)}{i \phi} \right] d\phi} \\
&amp; -Ke^{-r(T-t)}\left( \frac{1}{2} + \frac{1}{\pi} \int_{0}^{\infty}{\Re \left[ \frac{K^{-i \phi} f(i \phi)}{i \phi} \right]}  d\phi \right)
\end{split}
\end{align}\]</span>
</div>
<div id="euler-scheme" class="section level2">
<h2><span class="header-section-number">2.2</span> Euler Scheme</h2>
<p>Given the fact that the underlying asset is temporal dependent upon the solution of the SDE’s volatility, we simulate the volatility’s path before the asset’s. If the Black-Scholes model enabled using Ito’s Lemma directly for solving <span class="math inline">\(S_t\)</span>, this equation system requires numerical methods. We present here the Euler Scheme - Full Truncation algorithm (and compare to other similar schemes) <span class="citation">[4]</span> along with some insights on how it was implemented in R. The Euler discretization brings approximation paths to stock prices and variance processes. If we set <span class="math inline">\(t_0 = 0 &lt; t_1 &lt; \dots &lt; t_M = T\)</span> as partitions of a time interval of <span class="math inline">\(M\)</span> equal segments of lenght <span class="math inline">\(\delta t\)</span>, we have the following discretization for the stock price:</p>
<span class="math display">\[\begin{align}
S_{t+1} = S_t + rS_t + \sqrt{V_t} S_t Z_s
\end{align}\]</span>
<p>And for the variance process:</p>
<span class="math display">\[\begin{align}
V_{t+1} = f_1(V_{t}) + \kappa (\theta - f_2(V_{t})) + \sigma \sqrt{f_3(V_{t})} Z_v 
\end{align}\]</span>
<p><span class="math inline">\(Z_s\)</span> being a standard normal random variable, i.e. <span class="math inline">\(N\sim(0,1)\)</span>, we set <span class="math inline">\(Z_t\)</span> and <span class="math inline">\(Z_v\)</span> as two independent standard normal random variables and <span class="math inline">\(Z_s\)</span> and <span class="math inline">\(Z_v\)</span> having correlation <span class="math inline">\(\rho\)</span>. This means we can write <span class="math inline">\(Z_s = \rho Z_v + \sqrt{1-\rho^2} Z_t\)</span>.</p>
<p>The immediate observable problem in the proposed discretization scheme is that <span class="math inline">\(V\)</span> can become negative with non-zero probability making the computation of <span class="math inline">\(\sqrt{V_t}\)</span> impossible <span class="citation">[1]</span>. There are several proposed fixes that can be used as you can see below:</p>
<table>
<caption><span id="tab:fullt">Table 2.1: </span>Truncation schemes</caption>
<thead>
<tr class="header">
<th align="left">Scheme</th>
<th align="right"><span class="math inline">\(f_1(V_{t})\)</span></th>
<th align="right"><span class="math inline">\(f_2(V_{t})\)</span></th>
<th align="right"><span class="math inline">\(f_3(V_{t})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Reflection</td>
<td align="right"><span class="math inline">\(\mid V \mid\)</span></td>
<td align="right"><span class="math inline">\(\mid V \mid\)</span></td>
<td align="right"><span class="math inline">\(\mid V \mid\)</span></td>
</tr>
<tr class="even">
<td align="left">Partial Truncation</td>
<td align="right"><span class="math inline">\(V\)</span></td>
<td align="right"><span class="math inline">\(V\)</span></td>
<td align="right"><span class="math inline">\(V^+\)</span></td>
</tr>
<tr class="odd">
<td align="left">Full Truncation</td>
<td align="right"><span class="math inline">\(V\)</span></td>
<td align="right"><span class="math inline">\(V^+\)</span></td>
<td align="right"><span class="math inline">\(V^+\)</span></td>
</tr>
</tbody>
</table>
<p>Where <span class="math inline">\(V^+ = \max(V,0)\)</span> and <span class="math inline">\(\mid V \mid\)</span> is the absolute value of <span class="math inline">\(V\)</span>.</p>
<p>We chose to fix our discretization using the Full-Truncation (FT) scheme and thus, rewrite the equations as follows:</p>
<span class="math display">\[\begin{align}
S_{t+1} &amp;= S_t + rS_t + \sqrt{V_{t}^{+}} S_t Z_s \\
V_{t+1} &amp;= V_t + \kappa (\theta - V_{t}^{+}) + \sigma \sqrt{V_{t}^{+}} Z_v
\end{align}\]</span>
</div>
<div id="kahl-jackel" class="section level2">
<h2><span class="header-section-number">2.3</span> Kahl-Jackel</h2>
<p>Kahl-Jackel propose a discretization method they refer to as the ``IJK’’ method <span class="citation">[1,24]</span> that coupled with the implicit Milstein scheme for the variance lands the system of equations <a href="#eq:kj1">(<strong>??</strong>)</a> and <a href="#eq:kj2">(<strong>??</strong>)</a>. It is possible to verify that this discretization always results in positive paths for <span class="math inline">\(V\)</span> if <span class="math inline">\(4 \kappa \theta &gt; \sigma^2\)</span>. Unfortunately, this inequality is rarely satisfied when we plug real market data to calibrate the parameters.</p>

</div>
<div id="exact-algorithm" class="section level2">
<h2><span class="header-section-number">2.4</span> Exact Algorithm</h2>
<p>In 2006, Broadie-Kaya <span class="citation">[4]</span> propose a method that has a faster convergence rate, <span class="math inline">\(\mathcal{O} \left( s^{-1/2} \right)\)</span> than some of the more famous schemes, such as Euler’s and Milstein’s discretizations. They build their idea to generate an exact sample from the distribution of the terminal stock price based on numerous papers <span class="citation">[17]</span>. The stock price and variance are as follows:</p>
<span class="math display">\[\begin{align} \label{eq:ea1}
S_t = S_0 \, exp \left[ \mu t - \frac{1}{2} \int_{0}^{t}{V_s ds} + \rho  \int_{0}^{t}{\sqrt{V_s d B_s}} + \sqrt{1 - \rho^2} \int_{0}^{t}{\sqrt{V_s} dW_s}\right]
\end{align}\]</span>
<p>The squared volatility of the variance process is:</p>
<span class="math display">\[\begin{align} \label{eq:ea2}
V_t = V_0 + \kappa \theta t - \kappa \int_{0}^{t}{V_s ds} + \sigma \int_{0}^{t}{\sqrt{V_s dB_s}}
\end{align}\]</span>
<p>The algorithm used to generate the model consists in four steps as follows:</p>

<div id="generate-a-sample-of-v_t-given-v_0" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Generate a sample of <span class="math inline">\(V_t\)</span> given <span class="math inline">\(V_0\)</span></h3>
<p>The distribution of <span class="math inline">\(V_t\)</span> given <span class="math inline">\(V_0\)</span> for <span class="math inline">\(0 &lt; t\)</span> is a noncentral chi-squared distribution <span class="citation">[2,8]</span>:</p>
<p><span class="math display">\[V_t = \frac{\sigma^2 (1-e^{- \kappa t})}{4 \kappa} \mathcal{X}_{\delta}^{2} \left( \frac{4 \kappa e^{- \kappa t}}{\sigma^2 (1- e^{- \kappa t})} \times V_0\right)\]</span></p>
<p>where <span class="math inline">\(\delta = \frac{4 \theta \kappa}{\sigma^2}\)</span> and <span class="math inline">\(\mathcal{X}_{\delta}^{2}(\lambda)\)</span> denotes a noncentral chi-squared random variable with <span class="math inline">\(\delta\)</span> degrees of freedom and <span class="math inline">\(\lambda\)</span> as its noncentrality parameter.</p>
<p>Broadie and Kaya <span class="citation">[4]</span> sample generating Poisson and gamma distributions as in Johnson et al. <span class="citation">[23]</span>. We used the built-in function in R <span class="citation">[30]</span> which uses this exact method for sampling.</p>
</div>
<div id="generate-a-sample-of-int_0t-v_sds-given-v_t-v_0" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Generate a sample of <span class="math inline">\(\int_0^t V_sds\)</span> given <span class="math inline">\(V_t\)</span>, <span class="math inline">\(V_0\)</span></h3>
<p>After generating <span class="math inline">\(V_t\)</span>, we follow the instructions in <span class="citation">[4,23]</span>. We use the characteristic function <a href="#eq:phi">(<strong>??</strong>)</a> to compute the probability density function <span class="math inline">\(F(x)\)</span>.</p>
<span class="math display">\[\begin{align} \label{eq:phi}
\begin{split}
\Phi(a) &amp;= \mathbb{E}\left[ exp \left( ia \int_{0}^{t}{V_s ds} \mid V_0,V_t \right)  \right] \\[10pt]
&amp;= \frac{\gamma(a)e^{(-1/2)(\gamma(a)- \kappa) t} (1 - e^{- \kappa t})}{\kappa (1 - e^{- \gamma(a) t})} \\[10pt]
&amp;\times exp \left\{\frac{V_0 + V_t}{\sigma^2} \left[ \frac{\kappa (1 + e^{- \kappa t})}{1 - e^{- \kappa t}} - \frac{\gamma(a) (1 + e^{- \gamma(a) t})}{1 - e^{- \gamma(a) t}} \right] \right\} \\[10pt]
&amp;\times \frac{I_{0.5\delta - 1} \left[ \sqrt{V_0 V_t} \frac{4 \gamma(a) e^{-0.5 \gamma(a) t}}{\sigma^2 (1 - e^{- \gamma(a) t})} \right]}{I_{0.5\delta - 1}  \left[ \sqrt{V_0 V_t} \frac{4 \kappa e^{-0.5 \kappa t}}{\sigma^2 (1 - e^{- \kappa t})} \right]}
\end{split}
\end{align}\]</span>
<p>where <span class="math inline">\(\gamma(a) = \sqrt{\kappa^2 - 2 \sigma^2 i a}\)</span>, <span class="math inline">\(\delta\)</span> was previously defined and <span class="math inline">\(I_v(x)\)</span> is the modified Bessel function of the first kind.<a href="#fn12" class="footnoteRef" id="fnref12"><sup>12</sup></a></p>
<p>The probability distribution function is obtained in <span class="citation">[2,4]</span> by Fourier inversions using Feller <span class="citation">[11]</span>. We use the approach in Gil-Pelaez <span class="citation">[13]</span>, equation <a href="#eq:fourier">(<strong>??</strong>)</a>. We define <span class="math inline">\(V(u,t)\)</span> the random variable with the same distribution as the integral <span class="math inline">\(\int_{u}^{t}{V_s ds}\)</span>, conditional on <span class="math inline">\(V_u\)</span> and <span class="math inline">\(V_t\)</span>:</p>
<span class="math display">\[\begin{align} \label{eq:fourier}
F(x) \equiv Pr \left\{ V(u,t) \leq x \right\} = F_{X}(x)={\frac {1}{2}}-{\frac {1}{\pi }}\int _{0}^{\infty }{\frac {\operatorname {Im} [e^{-iux} phi (u)]}{u}}\,du
\end{align}\]</span>
<p><span class="math inline">\(\operatorname {Im}\)</span> denotes the imaginary part of <span class="math inline">\(e^{-iux} phi (u)\)</span>. Equation <a href="#eq:fourier">(<strong>??</strong>)</a> is computed numerically and we then sample it by inversion.</p>
<p>Furthermore, we also introduce a simpler version for this step, that computes this integral approximation, using the solution <span class="math inline">\(\int_{u}^{t}{V_s ds} = \frac{1}{2} \left( V_u + V_t \right)\)</span></p>
</div>
<div id="compute-int_0t-sqrtv_sdb_s-given-v_t-v_0-and-int_0t-v_sds" class="section level3">
<h3><span class="header-section-number">2.4.3</span> Compute <span class="math inline">\(\int_0^t \sqrt{V_s}dB_s\)</span> given <span class="math inline">\(V_t\)</span>, <span class="math inline">\(V_0\)</span> and <span class="math inline">\(\int_0^t V_sds\)</span></h3>
<p>From equation <a href="#eq:ea2">(<strong>??</strong>)</a> we are now able to compute this integral.</p>
<span class="math display">\[\begin{align} \label{eq:ea3}
\int_{0}^{t}{\sqrt{V_s dB_s}} = \frac{V_t - V_0 - \kappa \theta t + \kappa \int_{0}^{t}{V_s ds}}{\sigma} 
\end{align}\]</span>
<p>The last step of the algorithm consists of computing the conditional distribution of <span class="math inline">\(log S_t\)</span> based on the fact that the process for <span class="math inline">\(V_t\)</span> is independent from <span class="math inline">\(dB_t\)</span>, and the distribution of <span class="math inline">\(\displaystyle \int_0^t{\sqrt{V_s} dB_s}\)</span> is normal with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(\displaystyle \int_0^t{V_s ds}\)</span>, given <span class="math inline">\(V_t\)</span>.</p>
<p><span class="math display">\[m(u,t) = \log S_0 + \left[ \mu t - \frac{1}{2} \int_{0}^{t}{V_s ds} + \rho  \int_{0}^{t}{\sqrt{V_s d B_s}} + \sqrt{1 - \rho^2} \int_{0}^{t}{\sqrt{V_s} dW_s}\right]\]</span></p>
<p>and variance</p>
<p><span class="math display">\[\sigma^2(0,t) = \left( 1 - \rho^2 \right) \int_0^t{V_s ds}\]</span></p>
<p>We generate the <span class="math inline">\(S_t\)</span> sample using a standard normal random variable <span class="math inline">\(Z\)</span> and set:</p>
<p><span class="math display">\[S_t = e^{m(0,t) + \sigma (0,t) Z}\]</span></p>
</div>
<div id="limitations-1" class="section level3">
<h3><span class="header-section-number">2.4.4</span> Limitations</h3>
<p>The biggest limitation this scheme presents is that the second step is computationally costly. It demands the inversion of the distribution function of <span class="math inline">\(\left( \displaystyle \int_0^t V_sds \mid V_t, \, V_0 \right)\)</span> numerically. We must perform a root search of <span class="math inline">\(F(x_i) - U = 0\)</span> testing for different <span class="math inline">\(x_i\)</span>. Notwithstanding, we do not know the closed form of <span class="math inline">\(F(x_i)\)</span> distribution and have to perform our root finding strategy inverting the characteristic function, with two modified Bessel functions inside, in a structure that is rerun until a given tolerance <span class="math inline">\(\epsilon\)</span> is reached. Mathematically: <span class="math inline">\(F(x_i) - U = \epsilon\)</span>.</p>
<!-- Required to number equations in HTML files -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lt-review.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="results.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": [["thesis.pdf", "PDF"], ["thesis.epub", "EPUB"], ["thesis.docx", "Word"]],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
